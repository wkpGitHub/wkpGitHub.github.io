{"version":3,"file":"js/607.463e4ca1.js","mappings":"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","sources":["webpack://@cci/cp-charts-play/./src/views/pyramid.vue?fe56","webpack://@cci/cp-charts-play/../packages/pyramid/src/pyramid.vue?ef12","webpack://@cci/cp-charts-play/../packages/pyramid/src/pyramid.vue","webpack://@cci/cp-charts-play/../packages/pyramid/src/pyramid.vue?a704","webpack://@cci/cp-charts-play/../packages/pyramid/src/pyramid.vue?ccbe","webpack://@cci/cp-charts-play/../packages/pyramid/index.js","webpack://@cci/cp-charts-play/./src/views/pyramid.vue?8824","webpack://@cci/cp-charts-play/./src/views/pyramid.vue","webpack://@cci/cp-charts-play/../node_modules/.pnpm/three@0.149.0/node_modules/three/examples/jsm/renderers/CSS2DRenderer.js","webpack://@cci/cp-charts-play/../packages/utils/three.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c(_setup.CpPyramid)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"pyramidRef\",staticClass:\"chart\",style:({ width: _vm.width, height: _vm.height })})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div ref=\"pyramidRef\" class=\"chart\" :style=\"{ width, height }\" />\r\n</template>\r\n\r\n<script>\r\nimport { getCylinder, getTextLabel, render } from '@cci/cp-charts-utils'\r\n\r\nexport default {\r\n  name: 'Pyramid',\r\n  props: {\r\n    width: {\r\n      type: String,\r\n      default: '600px'\r\n    },\r\n    height: {\r\n      type: String,\r\n      default: '400px'\r\n    },\r\n    zoom: {\r\n      type: Number,\r\n      default: 1\r\n    },\r\n    level: {\r\n      type: Number,\r\n      default: 4\r\n    },\r\n    colors: {\r\n      type: Array,\r\n      default: () => [0xF5A62F, 0x0B996D, 0xB61B3D, 0x2A9CFF]\r\n    },\r\n    texts: {\r\n      type: Array,\r\n      default: () => ['金字塔1', '金字塔2', '金字塔3', '金字塔4']\r\n    }\r\n  },\r\n  mounted() {\r\n    const materials = []\r\n    for (let i = 0; i < this.level; i++) {\r\n      const material = getCylinder([i+0.1*i,1+i,2,4], [0,5-2.5*i,0], this.colors[i%this.colors.length])\r\n      material.add(getTextLabel(this.texts[i] || '无'))\r\n      materials.push(material)\r\n    }\r\n    render(this.$refs.pyramidRef, materials)\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.chart {\r\n  position: relative;\r\n  background-color: #0f131e;\r\n  margin: 0 24px;\r\n}\r\n\r\n.label {\r\n  font-size: 16px;\r\n  color: rgba(255, 255, 255, 0.8);\r\n  margin-left: 130px;\r\n\r\n  &::before {\r\n    content: '';\r\n    display: inline-block;\r\n    height: 1px;\r\n    width: 50px;\r\n    margin: 0 18px 5px 0;\r\n    background-color: rgba(255, 255, 255, 0.3);\r\n  }\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/.pnpm/vue-loader@15.10.1_ykpzdgyvk4j6dqv6wugxhfdndm/node_modules/vue-loader/lib/index.js??vue-loader-options!./pyramid.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/.pnpm/vue-loader@15.10.1_ykpzdgyvk4j6dqv6wugxhfdndm/node_modules/vue-loader/lib/index.js??vue-loader-options!./pyramid.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./pyramid.vue?vue&type=template&id=d4187f72&\"\nimport script from \"./pyramid.vue?vue&type=script&lang=js&\"\nexport * from \"./pyramid.vue?vue&type=script&lang=js&\"\nimport style0 from \"./pyramid.vue?vue&type=style&index=0&id=d4187f72&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/.pnpm/vue-loader@15.10.1_ykpzdgyvk4j6dqv6wugxhfdndm/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Pyramid from './src/pyramid.vue'\r\n\r\nexport default Pyramid","import mod from \"-!../../../node_modules/.pnpm/vue-loader@15.10.1_ykpzdgyvk4j6dqv6wugxhfdndm/node_modules/vue-loader/lib/index.js??vue-loader-options!./pyramid.vue?vue&type=script&setup=true&lang=js&\"; export default mod; export * from \"-!../../../node_modules/.pnpm/vue-loader@15.10.1_ykpzdgyvk4j6dqv6wugxhfdndm/node_modules/vue-loader/lib/index.js??vue-loader-options!./pyramid.vue?vue&type=script&setup=true&lang=js&\"","import { render, staticRenderFns } from \"./pyramid.vue?vue&type=template&id=ad1f8f16&\"\nimport script from \"./pyramid.vue?vue&type=script&setup=true&lang=js&\"\nexport * from \"./pyramid.vue?vue&type=script&setup=true&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/.pnpm/vue-loader@15.10.1_ykpzdgyvk4j6dqv6wugxhfdndm/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {\n\tMatrix4,\n\tObject3D,\n\tVector3\n} from 'three';\n\nclass CSS2DObject extends Object3D {\n\n\tconstructor( element = document.createElement( 'div' ) ) {\n\n\t\tsuper();\n\n\t\tthis.isCSS2DObject = true;\n\n\t\tthis.element = element;\n\n\t\tthis.element.style.position = 'absolute';\n\t\tthis.element.style.userSelect = 'none';\n\n\t\tthis.element.setAttribute( 'draggable', false );\n\n\t\tthis.addEventListener( 'removed', function () {\n\n\t\t\tthis.traverse( function ( object ) {\n\n\t\t\t\tif ( object.element instanceof Element && object.element.parentNode !== null ) {\n\n\t\t\t\t\tobject.element.parentNode.removeChild( object.element );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.element = source.element.cloneNode( true );\n\n\t\treturn this;\n\n\t}\n\n}\n\n//\n\nconst _vector = new Vector3();\nconst _viewMatrix = new Matrix4();\nconst _viewProjectionMatrix = new Matrix4();\nconst _a = new Vector3();\nconst _b = new Vector3();\n\nclass CSS2DRenderer {\n\n\tconstructor( parameters = {} ) {\n\n\t\tconst _this = this;\n\n\t\tlet _width, _height;\n\t\tlet _widthHalf, _heightHalf;\n\n\t\tconst cache = {\n\t\t\tobjects: new WeakMap()\n\t\t};\n\n\t\tconst domElement = parameters.element !== undefined ? parameters.element : document.createElement( 'div' );\n\n\t\tdomElement.style.overflow = 'hidden';\n\n\t\tthis.domElement = domElement;\n\n\t\tthis.getSize = function () {\n\n\t\t\treturn {\n\t\t\t\twidth: _width,\n\t\t\t\theight: _height\n\t\t\t};\n\n\t\t};\n\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\t\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\t\t_viewMatrix.copy( camera.matrixWorldInverse );\n\t\t\t_viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, _viewMatrix );\n\n\t\t\trenderObject( scene, scene, camera );\n\t\t\tzOrder( scene );\n\n\t\t};\n\n\t\tthis.setSize = function ( width, height ) {\n\n\t\t\t_width = width;\n\t\t\t_height = height;\n\n\t\t\t_widthHalf = _width / 2;\n\t\t\t_heightHalf = _height / 2;\n\n\t\t\tdomElement.style.width = width + 'px';\n\t\t\tdomElement.style.height = height + 'px';\n\n\t\t};\n\n\t\tfunction renderObject( object, scene, camera ) {\n\n\t\t\tif ( object.isCSS2DObject ) {\n\n\t\t\t\t_vector.setFromMatrixPosition( object.matrixWorld );\n\t\t\t\t_vector.applyMatrix4( _viewProjectionMatrix );\n\n\t\t\t\tconst visible = ( object.visible === true ) && ( _vector.z >= - 1 && _vector.z <= 1 ) && ( object.layers.test( camera.layers ) === true );\n\t\t\t\tobject.element.style.display = ( visible === true ) ? '' : 'none';\n\n\t\t\t\tif ( visible === true ) {\n\n\t\t\t\t\tobject.onBeforeRender( _this, scene, camera );\n\n\t\t\t\t\tconst element = object.element;\n\n\t\t\t\t\telement.style.transform = 'translate(-50%,-50%) translate(' + ( _vector.x * _widthHalf + _widthHalf ) + 'px,' + ( - _vector.y * _heightHalf + _heightHalf ) + 'px)';\n\n\t\t\t\t\tif ( element.parentNode !== domElement ) {\n\n\t\t\t\t\t\tdomElement.appendChild( element );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.onAfterRender( _this, scene, camera );\n\n\t\t\t\t}\n\n\t\t\t\tconst objectData = {\n\t\t\t\t\tdistanceToCameraSquared: getDistanceToSquared( camera, object )\n\t\t\t\t};\n\n\t\t\t\tcache.objects.set( object, objectData );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\t\trenderObject( object.children[ i ], scene, camera );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction getDistanceToSquared( object1, object2 ) {\n\n\t\t\t_a.setFromMatrixPosition( object1.matrixWorld );\n\t\t\t_b.setFromMatrixPosition( object2.matrixWorld );\n\n\t\t\treturn _a.distanceToSquared( _b );\n\n\t\t}\n\n\t\tfunction filterAndFlatten( scene ) {\n\n\t\t\tconst result = [];\n\n\t\t\tscene.traverse( function ( object ) {\n\n\t\t\t\tif ( object.isCSS2DObject ) result.push( object );\n\n\t\t\t} );\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfunction zOrder( scene ) {\n\n\t\t\tconst sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n\t\t\t\tif ( a.renderOrder !== b.renderOrder ) {\n\n\t\t\t\t\treturn b.renderOrder - a.renderOrder;\n\n\t\t\t\t}\n\n\t\t\t\tconst distanceA = cache.objects.get( a ).distanceToCameraSquared;\n\t\t\t\tconst distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n\t\t\t\treturn distanceA - distanceB;\n\n\t\t\t} );\n\n\t\t\tconst zMax = sorted.length;\n\n\t\t\tfor ( let i = 0, l = sorted.length; i < l; i ++ ) {\n\n\t\t\t\tsorted[ i ].element.style.zIndex = zMax - i;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport { CSS2DObject, CSS2DRenderer };\n","import {\r\n  Scene,\r\n  PerspectiveCamera,\r\n  WebGLRenderer,\r\n  ConeGeometry,\r\n  CylinderGeometry,\r\n  BufferGeometry,\r\n  Line,\r\n  Vector3,\r\n  Group,\r\n  MeshLambertMaterial,\r\n  LineBasicMaterial,\r\n  Mesh,\r\n  SpotLight,\r\n} from 'three'\r\nimport { CSS2DObject, CSS2DRenderer } from 'three/examples/jsm/renderers/CSS2DRenderer.js'\r\nimport { OrbitControls } from 'three/addons/controls/OrbitControls.js'\r\n\r\n// 椎体\r\nexport function getCone(params, position, color) {\r\n  const geometry = new ConeGeometry(...params)\r\n  const material = new MeshLambertMaterial({\r\n    color,\r\n    transparent: true,\r\n    opacity: 0.8\r\n  })\r\n  const cone = new Mesh(geometry, material)\r\n  cone.position.set(...position)\r\n  return cone\r\n}\r\n\r\n// 圆柱体\r\nexport function getCylinder(params, position, color, clippingPlanes = []) {\r\n  const geometry = new CylinderGeometry(...params)\r\n  const material = new MeshLambertMaterial({\r\n    color,\r\n    transparent: true,\r\n    opacity: 0.8,\r\n    clipIntersection: true,\r\n    clippingPlanes\r\n  })\r\n  const cylinder = new Mesh(geometry, material)\r\n  cylinder.position.set(...position)\r\n  return cylinder\r\n}\r\n\r\n// 线段\r\nexport function getLine(points = []) {\r\n  const material = new LineBasicMaterial({\r\n    color: 0xffffff,\r\n    linewidth: 1,\r\n    transparent: true,\r\n    opacity: 0.3\r\n  })\r\n  points = points.map(p => new Vector3(...p))\r\n  const geometry = new BufferGeometry().setFromPoints(points)\r\n  return new Line(geometry, material)\r\n}\r\n\r\n// 曲线\r\nexport function getCurve() {}\r\n\r\n// 字体\r\nexport function getTextLabel(text) {\r\n  const labelEl = document.createElement('div')\r\n  labelEl.className = 'label'\r\n  labelEl.textContent = text\r\n  const label = new CSS2DObject(labelEl)\r\n  return label\r\n}\r\n\r\n// 初始化渲染\r\nexport function render (el, materials = []) {\r\n  if (!el) return\r\n  const width = el.clientWidth, height = el.clientHeight\r\n  const renderer = new WebGLRenderer({\r\n    // 抗锯齿\r\n    antialias: true,\r\n    alpha: true\r\n  })\r\n  renderer.setSize(width, height)\r\n  renderer.localClippingEnabled = true //允许裁剪\r\n  el.appendChild(renderer.domElement)\r\n\r\n  const labelRenderer = new CSS2DRenderer()\r\n  labelRenderer.setSize(width, height)\r\n  labelRenderer.domElement.style.position = 'absolute'\r\n  labelRenderer.domElement.style.top = 0\r\n  labelRenderer.domElement.style.pointerEvents = 'none'\r\n  el.appendChild(labelRenderer.domElement)\r\n\r\n  const scene = new Scene()\r\n\r\n  const camera = new PerspectiveCamera(75,\r\n    width / height,\r\n    0.1,\r\n    1000\r\n  )\r\n  camera.position.set(0, 6, 12)\r\n  const controls = new OrbitControls(camera, renderer.domElement)\r\n\r\n  const group = new Group()\r\n  if (materials.length) {\r\n    for (const mtr of materials) {\r\n      group.add(mtr)\r\n    }\r\n  }\r\n  scene.add(group)\r\n\r\n  const light = new SpotLight(0xffffff, 1.3, 0, Math.PI/2)\r\n  scene.add(light)\r\n\r\n  // scene.add(new AxesHelper(10))\r\n  // scene.add(new CameraHelper(camera))\r\n  // scene.add(new SpotLightHelper(light))\r\n  // scene.add(new GridHelper(20, 20))\r\n\r\n  function animate() {\r\n    requestAnimationFrame(animate)\r\n    const { x, y, z } = camera.position\r\n    light.position.set(x, y, z)\r\n    controls.update()\r\n    renderer.render(scene, camera)\r\n    labelRenderer.render(scene, camera)\r\n  }\r\n\r\n  animate()\r\n}"],"names":["render","_vm","this","_c","_self","_setup","_setupProxy","CpPyramid","staticRenderFns","ref","staticClass","style","width","height","name","props","type","String","default","zoom","Number","level","colors","Array","texts","mounted","materials","i","material","length","add","push","$refs","pyramidRef","component","CSS2DObject","constructor","element","document","createElement","super","isCSS2DObject","position","userSelect","setAttribute","addEventListener","traverse","object","Element","parentNode","removeChild","copy","source","recursive","cloneNode","_vector","_viewMatrix","_viewProjectionMatrix","_a","_b","CSS2DRenderer","parameters","_this","_width","_height","_widthHalf","_heightHalf","cache","objects","WeakMap","domElement","undefined","renderObject","scene","camera","setFromMatrixPosition","matrixWorld","applyMatrix4","visible","z","layers","test","display","onBeforeRender","transform","x","y","appendChild","onAfterRender","objectData","distanceToCameraSquared","getDistanceToSquared","set","l","children","object1","object2","distanceToSquared","filterAndFlatten","result","zOrder","sorted","sort","a","b","renderOrder","distanceA","get","distanceB","zMax","zIndex","overflow","getSize","matrixWorldAutoUpdate","updateMatrixWorld","parent","matrixWorldInverse","multiplyMatrices","projectionMatrix","setSize","getCylinder","params","color","clippingPlanes","geometry","transparent","opacity","clipIntersection","cylinder","getTextLabel","text","labelEl","className","textContent","label","el","clientWidth","clientHeight","renderer","antialias","alpha","localClippingEnabled","labelRenderer","top","pointerEvents","controls","OrbitControls","group","mtr","light","Math","PI","animate","requestAnimationFrame","update"],"sourceRoot":""}